---
import BlogPostCard from './BlogPostCard.astro';
import { getCollection } from 'astro:content';

// Get blog posts and sort by date
const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

// Get the latest 3 posts for homepage
const latestPosts = sortedPosts.slice(0, 3);
---

<section class="blog-section">
  <div class="container">
    <div class="section-header">
      <h2 class="section-title">Latest Articles</h2>
      <p class="section-description">Discover tips, tricks, and insights about invisible characters and Unicode</p>
      <a href="/blog" class="view-all-link">
        View All Articles
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m9 18 6-6-6-6"></path>
        </svg>
      </a>
    </div>
    
    <div class="blog-grid">
      {latestPosts.map(post => (
        <BlogPostCard
          title={post.data.title}
          description={post.data.description}
          pubDate={post.data.pubDate}
          slug={post.slug}
          image={post.data.image}
          tags={post.data.tags}
          featured={post.data.featured}
        />
      ))}
    </div>
  </div>
</section>

<style>
  .blog-section {
    padding: 4rem 0;
    background-color: var(--navy-900);
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }
  
  .section-header {
    text-align: center;
    margin-bottom: 3rem;
  }
  
  .section-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--yellow-400);
    margin-bottom: 1rem;
  }
  
  .section-description {
    font-size: 1.125rem;
    color: var(--gray-400);
    margin-bottom: 2rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
  
  .view-all-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--yellow-400);
    font-weight: 500;
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border: 2px solid var(--yellow-400);
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }
  
  .view-all-link:hover {
    background-color: var(--yellow-400);
    color: var(--navy-900);
    transform: translateY(-2px);
  }
  
  .blog-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  @media (min-width: 768px) {
    .blog-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (min-width: 1024px) {
    .blog-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }
  
  @media (max-width: 767px) {
    .section-title {
      font-size: 2rem;
    }
    
    .section-description {
      font-size: 1rem;
    }
    
    .blog-section {
      padding: 3rem 0;
    }
  }
</style> 