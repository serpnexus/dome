---
// src/pages/index.astro - Homepage
import Layout from '../../layouts/Blog.astro';
import Hero from '../../components/blog/Hero.astro';
import FeaturedPosts from '../../components/blog/FeaturedPosts.astro';
import { fetchPageBySlug, fetchPosts, getHeroData, getSEOData } from '../../lib/wordpress.js';

const homepage = await fetchPageBySlug('home');
const featuredPosts = await fetchPosts({ per_page: 3 });
const heroData = homepage ? getHeroData(homepage) : {};
const seoData = homepage ? getSEOData(homepage) : {};
---

<Layout 
  title={seoData.title || "Welcome to Our Site"}
  description={seoData.description || "Your amazing website"}
  image={seoData.image}
>
  <!-- Hero Section -->
  <Hero 
    title={heroData.title || homepage?.title?.rendered || "Welcome"}
    subtitle={heroData.subtitle || homepage?.excerpt?.rendered}
    ctaText={heroData.cta_text || "Learn More"}
    ctaLink={heroData.cta_link || "#"}
    backgroundImage={homepage?.featured_image_data?.sizes?.large?.[0]}
  />
  
  <!-- Featured Posts -->
  {featuredPosts && featuredPosts.length > 0 && (
    <FeaturedPosts posts={featuredPosts} />
  )}
  
  <!-- Page Content -->
  {homepage && homepage.content?.rendered && (
    <section class="py-16">
      <div class="container mx-auto px-4">
        <div class="prose prose-lg max-w-none" set:html={homepage.content.rendered} />
      </div>
    </section>
  )}
</Layout>